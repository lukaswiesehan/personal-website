import {useEffect} from 'react'
import {motion, useCycle} from 'framer-motion'
import {useTheme} from 'next-themes'

export const LightSwitch = () => {
  const {theme, setTheme} = useTheme()
  const [isDark, toggleDark] = useCycle(false, true)

  const toggleDarkMode = () => {
    if(theme =='dark') {
      setTheme('light')
    } else {
      setTheme('dark')
    }
    toggleDark()
  }
  
  const baseVariants = {
    dark: {rotate: 15, x: -6},
    light: {rotate: 0, x: 0}
  }

  const onVariants = {
    dark: {opacity: 0},
    light: {opacity: 1}
  }

  const offVariants = {
    dark: {opacity: 1},
    light: {opacity: 0}
  }

  const raysVariants = {
    dark: {},
    light: {transition: {staggerChildren: 0.07}}
  }

  const rayVariants = {
    dark: {scale: 0, opacity: 0, duration: 0.1},
    light: {scale: 1, opacity: 1}
  }

  useEffect(() => {
    if((theme =='light' && isDark) || (theme == 'dark' && !isDark)) toggleDark()
  }, [])

  return (
    <button onClick={toggleDarkMode} className="text-teal-600 dark:text-teal-500 text-xl">
      <motion.div initial={false} animate={isDark ? 'dark' : 'light'} variants={baseVariants}>
        <svg className="h-6 fill-current" viewBox="0 0 512 410">
          <g>
            <motion.path id="base" d="M77.4230937 363.848436C77.4339434 368.881877 78.9282254 373.800674 81.7194687 377.991011L95.4261875 398.564214C99.6183594 404.898743 109.189016 410 116.779812 410L166.236219 410C173.827016 410 183.397672 404.898743 187.589844 398.564214L201.288547 377.991011C203.892557 373.71218 205.383331 368.850286 205.625 363.848436L205.625 333.144793 77.375 333.144793 77.4230937 363.848436zM141 0C59.0597727 0 0 66.442118 0 140.940253 0 176.471611 13.1786932 208.887869 34.8975 233.656517 48.2284091 248.86365 69.1380682 280.743374 76.8930682 307.457958L76.8930682 307.506006 115.347614 307.506006 115.347614 307.40991C115.339602 303.590109 114.770795 299.794332 113.62517 296.142698 109.146818 281.880505 95.3432386 244.275083 63.8185227 208.319303 47.3631818 189.556632 38.5667045 165.756948 38.4946023 140.940253 38.334375 81.9695697 86.2984091 38.4382507 141 38.4382507 197.544205 38.4382507 243.545455 84.4200082 243.545455 140.940253 243.545455 165.740932 234.540682 189.668744 218.189489 208.319303 186.857045 244.042852 172.989375 281.568195 168.43892 295.974531 167.264523 299.67848 166.664725 303.540407 166.660398 307.425926L166.660398 307.506006 205.114943 307.506006 205.114943 307.465966C212.869943 280.743374 233.779602 248.86365 247.110511 233.664525 268.821307 208.887869 282 176.471611 282 140.940253 282 63.102795 218.870455 0 141 0z" transform="translate(114)"/>
            <motion.path id="off" variants={offVariants} d="M76.8765015,0 C34.4823141,0 0,34.4823141 0,76.8765015 C0,83.955546 5.73370574,89.6892517 12.8127502,89.6892517 C19.8917948,89.6892517 25.6255005,83.955546 25.6255005,76.8765015 C25.6255005,48.6083713 48.6243872,25.6255005 76.8765015,25.6255005 C83.955546,25.6255005 89.6892517,19.8917948 89.6892517,12.8127502 C89.6892517,5.73370574 83.955546,0 76.8765015,0 Z" transform="translate(179.064 64.064)"/>
            <motion.path id="on" variants={onVariants} d="M140.634413,0.000724422222 C58.8670222,0.249708963 0.000135690527,66.4699559 0.000135690527,140.946712 C-0.0473452416,175.069405 12.3675755,208.037211 34.9163347,233.666269 C48.1581472,248.761827 68.8705222,280.29032 76.7659128,306.893738 C76.7659128,307.117969 76.8220222,307.318176 76.8540847,307.518382 L205.29646,307.518382 C205.29646,307.318176 205.352569,307.117969 205.384632,306.893738 C213.280022,280.29032 233.992397,248.761827 247.23421,233.666269 C269.782969,208.037211 282.19789,175.069405 282.150409,140.946712 C282.150409,62.9703492 218.754694,-0.246802745 140.634413,0.000724422222 Z M141.075272,76.8806853 C105.676493,76.9204053 76.9900287,105.580488 76.9502722,140.946712 C76.9502722,148.02325 71.2083241,153.759917 64.1252722,153.759917 C57.0422202,153.759917 51.3002722,148.02325 51.3002722,140.946712 C51.3532863,91.4329023 91.5158846,51.30724 141.075272,51.2542746 C148.158324,51.2542746 153.900272,56.990942 153.900272,64.0674799 C153.900272,71.1440178 148.158324,76.8806853 141.075272,76.8806853 Z" transform="translate(114.425)"/>
            <motion.g id="rays" variants={raysVariants} transform="translate(-1 15.843)">
              <motion.g id="bottom-rays" variants={rayVariants}>
                <path d="M54.345183,2.40655085 L9.92258929,28.0329616 C3.83593923,31.3982604 0.0419718977,37.7843898 0,44.7344046 C-0.0412799519,51.6844193 3.67592117,58.1154528 9.72182505,61.5532839 C15.7677289,64.9911151 23.2003364,64.9001028 29.1600893,61.3152625 L73.582683,35.6888518 C82.5677204,30.284278 85.5641114,18.6853487 80.3193351,9.61149692 C75.0745587,0.537645113 63.521533,-2.66703804 54.345183,2.40655085 L54.345183,2.40655085 Z" transform="translate(31.486 211.765)"/>
                <path d="M73.582683,28.3803685 L29.1600893,2.75395774 C23.2003364,-0.8308826 15.7677289,-0.921894836 9.72182505,2.5159363 C3.67592117,5.95376743 -0.0412799519,12.3848009 -1.13686838e-13,19.3348157 C0.0419718977,26.2848305 3.83593923,32.6709598 9.92258929,36.0362587 L54.345183,61.6626694 C63.521533,66.7362583 75.0745587,63.5315751 80.3193351,54.4577233 C85.5641114,45.3838715 82.5677204,33.7849423 73.582683,28.3803685 L73.582683,28.3803685 Z" transform="translate(398.009 211.418)"/>
              </motion.g>
              <motion.g id="middle-rays" variants={rayVariants}>
                <path d="M89.775,19.219808 C89.775,8.60500117 81.1620779,0 70.5375,0 L19.2375,0 C8.61292213,0 0,8.60500117 0,19.219808 C0,29.8346149 8.61292213,38.4396161 19.2375,38.4396161 L70.5375,38.4396161 C81.1620779,38.4396161 89.775,29.8346149 89.775,19.219808 Z" transform="translate(0 118.697)"/>
                <path d="M70.5375,0 L19.2375,0 C8.61292213,0 1.13686838e-13,8.60500117 1.13686838e-13,19.219808 C1.13686838e-13,29.8346149 8.61292213,38.4396161 19.2375,38.4396161 L70.5375,38.4396161 C81.1620779,38.4396161 89.775,29.8346149 89.775,19.219808 C89.775,8.60500117 81.1620779,0 70.5375,0 Z" transform="translate(423.225 118.697)"/>
              </motion.g>
              <motion.g id="top-rays" variants={rayVariants}>
                <path d="M73.582683,28.3803685 L29.1600893,2.75395774 C23.2003364,-0.8308826 15.7677289,-0.921894836 9.72182505,2.5159363 C3.67592117,5.95376743 -0.0412799519,12.3848009 0,19.3348157 C0.0419718977,26.2848305 3.83593923,32.6709598 9.92258929,36.0362587 L54.345183,61.6626694 C60.304936,65.2475097 67.7375434,65.338522 73.7834473,61.9006908 C79.8293512,58.4628597 83.5465523,52.0318262 83.5052723,45.0818114 C83.4633004,38.1317967 79.6693331,31.7456673 73.582683,28.3803685 L73.582683,28.3803685 Z" transform="translate(31.486)"/>
                <path d="M19.2328414,63.8939552 C22.6110638,63.9004002 25.9304234,63.0105245 28.8515914,61.3152625 L73.2741851,35.6888518 C82.2592225,30.284278 85.2556135,18.6853487 80.0108371,9.61149692 C74.7660608,0.537645113 63.2130351,-2.66703804 54.0366851,2.40655085 L9.61409136,28.0329616 C2.07749622,32.3840702 -1.59572474,41.2489897 0.657366595,49.6490432 C2.91045793,58.0490968 10.5284014,63.8910291 19.2328414,63.8939552 L19.2328414,63.8939552 Z" transform="translate(398.333 .347)"/>
              </motion.g>
            </motion.g>
          </g>
        </svg>
      </motion.div>
      
    </button>
  )
}